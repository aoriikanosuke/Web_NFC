<!doctype html>
<html lang="ja">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover" />
  <meta name="theme-color" content="#9ebbe6" />
  <title>NFCスタンプラリー</title>
  <link href="https://fonts.googleapis.com/css2?family=M+PLUS+1p:wght@400;700&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="./css/stylesheet.css" />
</head>
<body>
  <div class="bg-layer" aria-hidden="true"></div>
  <div class="device">
    <div class="phone">
      <div class="app">
<!-- 背景（ガラス映え用） -->

      <div id="bg-wrap" aria-hidden="true">
        <svg viewBox="0 0 100 100" preserveAspectRatio="xMidYMid slice">
          <defs>
            <radialGradient id="Gradient1" cx="50%" cy="50%" fx="0.441602%" fy="50%" r=".5">
              <animate attributeName="fx" dur="34s" values="0%;3%;0%" repeatCount="indefinite"></animate>
              <stop offset="0%" stop-color="rgba(232, 16, 245, 0.9)"></stop>
              <stop offset="100%" stop-color="rgba(232, 16, 245, 0)"></stop>
            </radialGradient>
            <radialGradient id="Gradient2" cx="50%" cy="50%" fx="2.68147%" fy="50%" r=".5">
              <animate attributeName="fx" dur="23.5s" values="0%;3%;0%" repeatCount="indefinite"></animate>
              <stop offset="0%" stop-color="rgba(245, 240, 0, 0.9)"></stop>
              <stop offset="100%" stop-color="rgba(245, 240, 0, 0)"></stop>
            </radialGradient>
            <radialGradient id="Gradient3" cx="50%" cy="50%" fx="0.836536%" fy="50%" r=".5">
              <animate attributeName="fx" dur="21.5s" values="0%;3%;0%" repeatCount="indefinite"></animate>
              <stop offset="0%" stop-color="rgba(0, 255, 255, 1)"></stop>
              <stop offset="100%" stop-color="rgba(0, 255, 255, 0)"></stop>
            </radialGradient>
            <radialGradient id="Gradient4" cx="50%" cy="50%" fx="4.56417%" fy="50%" r=".5">
              <animate attributeName="fx" dur="23s" values="0%;5%;0%" repeatCount="indefinite"></animate>
              <stop offset="0%" stop-color="rgba(0, 255, 0, 1)"></stop>
              <stop offset="100%" stop-color="rgba(0, 255, 0, 0)"></stop>
            </radialGradient>
            <radialGradient id="Gradient5" cx="50%" cy="50%" fx="2.65405%" fy="50%" r=".5">
              <animate attributeName="fx" dur="24.5s" values="0%;5%;0%" repeatCount="indefinite"></animate>
              <stop offset="0%" stop-color="rgba(40, 120, 255, 1)"></stop>
              <stop offset="100%" stop-color="rgba(40, 120, 255, 0)"></stop>
            </radialGradient>
            <radialGradient id="Gradient6" cx="50%" cy="50%" fx="0.981338%" fy="50%" r=".5">
              <animate attributeName="fx" dur="25.5s" values="0%;5%;0%" repeatCount="indefinite"></animate>
              <stop offset="0%" stop-color="rgba(255,0,0, 1)"></stop>
              <stop offset="100%" stop-color="rgba(255,0,0, 0)"></stop>
            </radialGradient>
          </defs>
          <rect x="13.744%" y="1.18473%" width="100%" height="100%" fill="url(#Gradient1)" transform="rotate(334.41 50 50)">
            <animate attributeName="x" dur="20s" values="25%;0%;25%" repeatCount="indefinite"></animate>
            <animate attributeName="y" dur="21s" values="0%;25%;0%" repeatCount="indefinite"></animate>
            <animateTransform attributeName="transform" type="rotate" from="0 50 50" to="360 50 50" dur="7s" repeatCount="indefinite"></animateTransform>
          </rect>
          <rect x="-2.17916%" y="35.4267%" width="100%" height="100%" fill="url(#Gradient2)" transform="rotate(255.072 50 50)">
            <animate attributeName="x" dur="23s" values="-25%;0%;-25%" repeatCount="indefinite"></animate>
            <animate attributeName="y" dur="24s" values="0%;50%;0%" repeatCount="indefinite"></animate>
            <animateTransform attributeName="transform" type="rotate" from="0 50 50" to="360 50 50" dur="12s" repeatCount="indefinite"></animateTransform>
          </rect>
          <rect x="9.00483%" y="14.5733%" width="100%" height="100%" fill="url(#Gradient3)" transform="rotate(139.903 50 50)">
            <animate attributeName="x" dur="25s" values="0%;25%;0%" repeatCount="indefinite"></animate>
            <animate attributeName="y" dur="12s" values="0%;25%;0%" repeatCount="indefinite"></animate>
            <animateTransform attributeName="transform" type="rotate" from="360 50 50" to="0 50 50" dur="9s" repeatCount="indefinite"></animateTransform>
          </rect>
        </svg>
      </div>
      <div class="bg-orbs" aria-hidden="true">
        <span class="orb o1"></span>
        <span class="orb o2"></span>
        <span class="orb o3"></span>
      </div>
      <!-- Golden overlay for full-background sparkles -->
      <div id="goldenOverlay" class="golden-overlay" aria-hidden="true"></div>
      <!-- NFC hint (non-text) -->
      <div class="nfc-hint" aria-hidden="true">
        <span class="nfc-ring r1"></span>
        <span class="nfc-ring r2"></span>
        <span class="nfc-ring r3"></span>
        <span class="nfc-tag"></span>
      </div>
      <!-- Header -->
      <header class="header">
        <div id="siteInfoTrigger" class="title is-clickable" role="button" tabindex="0" aria-label="サイト説明を表示">
          <img class="title-png" src="./images/NEW_title.png" alt="NFCスタンプラリー">
          <!-- <div class="title-big">NFC</div>
          <div class="title-sub">スタンプラリー</div> -->
        </div>

        <!-- 全体はほどほど、OOPは通常ガラス -->
        <button id="oopInfo" class="oop-pill glass" type="button" aria-label="ポイントの説明を表示">
          <span id="oopValue" class="oop-value">0</span>
          <span class="oop-label">P</span>
        </button>
        <!-- SCAN をポイント下に表示 -->
        <div class="scan-top">
          <button id="scanBtn" class="scan-mini glass" type="button">SCAN</button>
        </div>
      </header>

      <!-- Pages (no reload) -->
      <main class="main">
        <!-- Stamp -->
        <section id="page-stamp" class="page is-active" aria-label="スタンプ">
          <div class="stamp-card glass">
            <div id="stampCarousel" class="stamp-carousel" aria-label="スタンプ押印エリア">
              <div class="stamp-track"></div>
            </div>

            <div id="indicator" class="indicator" aria-label="ページインジケータ"></div>

            <!-- Chips を枠内の右下に配置 -->
            <div class="below-row inside-card">
              <button id="chipsBtn" class="chips-btn glass" type="button">Chips</button>
            </div>
          </div>

          <button id="resetBtn" class="reset-hidden" type="button">RESET</button>
        </section>

        <!-- Pay -->
        <section id="page-pay" class="page" aria-label="決済">
          <div class="pay-shell glass">
            <div id="payRotator" class="pay-rotator" aria-live="polite">
              <div class="pay-view pay-view--customer">
                <div class="pay-header">
                  <div class="pay-title">決済</div>
                  <div class="pay-balance">利用可能 <span id="payAvailable">0</span>P</div>
                </div>

                <div class="pay-display">
                  <div id="payAmount" class="pay-amount">0</div>
                  <div class="pay-currency">P</div>
                </div>

                <div id="payKeypad" class="pay-keypad" aria-label="金額入力テンキー">
                  <button class="pay-key glass" data-paykey="1" type="button">1</button>
                  <button class="pay-key glass" data-paykey="2" type="button">2</button>
                  <button class="pay-key glass" data-paykey="3" type="button">3</button>
                  <button class="pay-key glass" data-paykey="4" type="button">4</button>
                  <button class="pay-key glass" data-paykey="5" type="button">5</button>
                  <button class="pay-key glass" data-paykey="6" type="button">6</button>
                  <button class="pay-key glass" data-paykey="7" type="button">7</button>
                  <button class="pay-key glass" data-paykey="8" type="button">8</button>
                  <button class="pay-key glass" data-paykey="9" type="button">9</button>
                  <button class="pay-key glass" data-paykey="clear" type="button">C</button>
                  <button class="pay-key glass" data-paykey="0" type="button">0</button>
                  <button class="pay-key glass" data-paykey="back" type="button">←</button>
                </div>

                <div class="pay-actions">
                  <button id="payConfirmBtn" class="pay-primary pay-primary--wide" type="button">決定</button>
                </div>
              </div>

              <div class="pay-view pay-view--staff" aria-label="店員確認画面">
                <div class="pay-display pay-display--staff">
                  <div id="payConfirmAmount" class="pay-amount">0</div>
                  <div class="pay-currency">P</div>
                </div>
                <div class="pay-actions pay-actions--staff">
                  <button id="payCommitBtn" class="pay-primary pay-primary--staff" type="button">決済確定</button>
                  <button id="payBackBtn" class="pay-action pay-action--staff glass" type="button">キャンセル</button>
                </div>
                <div id="payStatus" class="pay-status" aria-live="polite"></div>
              </div>
            </div>
          </div>

        </section>

        <!-- Profile -->
        <section id="page-profile" class="page" aria-label="プロフィール">
          <div class="page-center glass">
            <h2 class="page-title">プロフィール</h2>
            <div id="user-info" style="display: none;">
              <p>ようこそ、<span id="display-username"></span>さん</p>
              <div class="profile-actions">
                <button class="chips-btn glass danger" type="button" onclick="logout()">ログアウト</button>
                <button id="rankingBtn" class="chips-btn glass" type="button">ランキング</button>
              </div>
            </div>
            <button id="auth-trigger-btn" class="chips-btn glass" type="button" onclick="openAuthModal()">ログイン/会員登録</button>
          </div>

          <div id="auth-modal" class="modal" aria-hidden="true">
            <div class="modal-backdrop" onclick="closeAuthModal()"></div>
            <div class="modal-panel glass" role="dialog" aria-labelledby="auth-title">
              <div class="modal-head">
                <div id="auth-title" class="modal-title">ログイン</div>
                <button class="modal-close" type="button" onclick="closeAuthModal()">✕</button>
              </div>
              <div class="modal-body auth-form">
                <div id="auth-choice" class="auth-actions">
                  <button id="auth-login-choice" class="chips-btn glass" type="button">ログイン</button>
                  <button id="auth-register-choice" class="chips-btn glass" type="button">新規会員登録</button>
                </div>
                <div id="auth-form" hidden>
                  <div class="auth-input-group">
                    <input type="text" id="auth-username" class="glass" placeholder="ユーザー名">
                    <input type="password" id="auth-password" class="glass" placeholder="パスワード">
                  </div>
                  <div class="auth-actions">
                    <button id="auth-submit-btn" class="chips-btn glass" onclick="handleAuth()">実行</button>
                  </div>
                  <p id="auth-toggle-text" class="auth-toggle-btn" onclick="toggleAuthMode()">新規登録はこちら</p>
                </div>
              </div>
            </div>
          </div>
          <div id="rankingModal" class="ranking-modal" aria-hidden="true">
            <div class="ranking-backdrop" data-close="1"></div>
            <div class="ranking-panel glass" role="dialog" aria-modal="true" aria-label="ランキング">
              <div class="ranking-head">
                <div class="ranking-title">ランキング</div>
                <button class="modal-close" type="button" data-close="1">?</button>
              </div>
              <div id="rankingList" class="ranking-list"></div>
            </div>
          </div>

          <!-- Subtle Golden Card tucked bottom-right of profile page -->
          <!-- <div class="golden-card glass" aria-hidden="true">
            <div class="golden-head">
              <h4 style="margin:0; font-weight:800; font-size:15px;">ゴールデンモード</h4>
              <div id="goldenStatus" style="font-weight:700; font-size:13px;">未解禁</div>
            </div>
            <div class="golden-body">
              <div class="golden-actions">
                <button id="unlockGoldenBtn" class="chips-btn glass" type="button">50Pで解禁</button>
                <button id="toggleGoldenBtn" class="chips-btn glass" type="button" style="display:none;">ゴールデン:OFF</button>
              </div>
            </div>
            <div class="golden-sparks" aria-hidden="true">
            </div>
          </div> -->
        </section>
      </main>

      <!-- Stamp animation overlay -->
      <div id="stampAni" class="stamp-ani" aria-hidden="true">
        <div class="stamp-ani-sprite"></div>
      </div>

      <!-- Bottom Nav（ここを強めのガラスに） -->
      <nav class="bottom-nav glass-nav" aria-label="ボトムナビゲーション">
        <button class="nav-btn is-active" data-target="stamp" aria-label="スタンプ">
          <span class="nav-ico"><img class="nav-ico-img" src="./images/stamp.png" alt="スタンプ"></span>
        </button>
        <button class="nav-btn" data-target="pay" aria-label="決済">
          <span class="nav-ico"><img class="nav-ico-img" src="./images/pay.png" alt="決済"></span>
        </button>
        <button class="nav-btn" data-target="profile" aria-label="プロフィール">
          <span class="nav-ico"><img class="nav-ico-img" src="./images/profile.png" alt="プロフィール"></span>
        </button>
      </nav>

      <!-- Modal -->
      <div id="modal" class="modal" aria-hidden="true">
        <div class="modal-backdrop" data-close="1"></div>
        <div class="modal-panel glass" role="dialog" aria-modal="true" aria-label="location情報">
          <div class="modal-head">
            <div id="modalTitle" class="modal-title">location</div>
            <button class="modal-close" type="button" data-close="1">✕</button>
          </div>
          <div id="modalBody" class="modal-body"></div>
        </div>
      </div>
      <div id="paySuccess" class="pay-success" aria-hidden="true">
        <div class="pay-success-card">
          <div class="pay-success-title">決済完了</div>
          <div class="pay-success-amount">
            <span id="paySuccessAmount">0</span>
            <span class="pay-success-unit">P</span>
          </div>
          <div class="pay-success-sub">ご利用ありがとうございました</div>
          <div class="pay-success-consumed">
            消費ポイント <span id="paySuccessConsumed">0</span>P
          </div>
        </div>
      </div>
      <div id="completeOverlay" class="complete-overlay" aria-hidden="true">
        <div class="complete-card glass">
          <div class="complete-title">congratulation!!</div>
          <div class="complete-text">全てのスタンプを獲得しました。</div>
          <button id="completeBonusBtn" class="pay-primary" type="button">100Pを受け取る</button>
        </div>
      </div>
      <div id="siteInfoOverlay" class="site-info" aria-hidden="true">
        <div class="site-info-top">
          <img class="site-info-title" src="./images/NEW_title.png" alt="NFCスタンプラリー">
          <p class="site-info-text">NFCスタンプを集めてポイントをため、<br>決済で使えるスタンプラリーアプリです。</p>
        </div>
        <div class="site-info-flow">
          <button id="siteInfoStartBtn" class="site-info-btn site-info-btn--start" type="button">はじめる</button>
          <div class="site-info-actions" aria-label="ログインまたは会員登録">
            <button id="siteInfoLoginBtn" class="site-info-btn" type="button">ログイン</button>
            <button id="siteInfoSignupBtn" class="site-info-btn" type="button">会員登録</button>
          </div>
          <div id="siteInfoForm" class="site-info-form" aria-hidden="true">
            <div id="siteInfoFormTitle" class="site-info-form-title" aria-hidden="true"></div>
            <div class="site-info-form-fields">
              <input id="siteInfoUsername" class="site-info-input" type="text" placeholder="ユーザー名">
              <input id="siteInfoPassword" class="site-info-input" type="password" placeholder="パスワード">
            </div>
            <button id="siteInfoSubmitBtn" class="site-info-btn site-info-btn--submit" type="button">ログイン</button>
            <button id="siteInfoToggleLink" class="site-info-link" type="button">会員登録の場合はこちら</button>
            <div id="siteInfoFormError" class="site-info-error" aria-live="polite"></div>
          </div>
        </div>
      </div>
    </div>
    <!-- デバッグUI（デスクトップ時のみ表示） -->
    <div class="debug-tools" aria-hidden="true">
      <button id="debugToggle" class="glass debug-toggle-btn" type="button">デバッグモード</button>
      <div id="debugPanel" class="debug-panel glass" aria-hidden="true"></div>
    </div>
  </div>

  <!-- app -->
  <script src="./js/script.js?v=20250115" defer></script>
</body>
</html>


